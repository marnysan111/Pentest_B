<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="register.css">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
    <title>新規登録</title>
  </head>

<body>
    <div class="container">
        <div class="row">
            <div class="col">
                <a href="/"><img src="./material/ロゴ.png" width="198.2px" height="90.1px"></a>
            </div>

            <a href="notyetopen.html"><img class="icon" src="./material/favorite.png"></a>
            <a href="notyetopen.html"><img class="icon" src="./material/cart.png"></a>
            <a href="login.html"><img class="icon" src="./material/login.png"></a>
        </div>

    <hr width="100%">

    <ul class="tab-menu">
        <a href="/"><li class="tab-item">TOP</li></a>
        <a href="notyetopen.html"><li class="tab-item">SET</li></a>
        <a href="notyetopen.html"><li class="tab-item">CHAIR</li></a>
        <a href="notyetopen.html"><li class="tab-item">TABLE</li></a>
        <a href="notyetopen.html"><li class="tab-item">BED</li></a>
        <a href="notyetopen.html"><li class="tab-item">CARPET</li></a>
        <a href="notyetopen.html"><li class="tab-item">OTHER</li></a>
    </ul>

    <hr width="100%">

    <div class="registtop">新規登録</div>

    <?php
    if($_SERVER['REQUEST_METHOD'] === 'POST'){
        $username = $_POST["username"];
        $email = $_POST["email"];
        $passwd = $_POST["passwd"];

        $dsn = 'mysql:dbname=tmcit;host=localhost';
        $user = 'root';
        $password = 'Tmcit17!';

        $dbh = new PDO($dsn, $user, $password);
        $query = "select * from users where name = '$username';";
        $stmt = $dbh->query($query);
        $row = $stmt->fetch(PDO::FETCH_ASSOC);  
        


        if ($row["name"] == null) {
            $query = "insert into users (name, password, email) value ('$username', '$passwd', '$email');";
            $stmt = $dbh->query($query);
            echo "登録しました";
        } else {
            echo "すでに登録されている氏名です";
        }
        
        $dbh = null;
    }
    ?>


    <form action="register.php" method="post" onsubmit="return check()">
        <div class="registname">
            <div class="form-group">
                <input type="text" class="form-control" id="username" placeholder="氏名" name="username">
            </div>
        </div>
    
        <div class="registmail">
            <div class="form-group">
                <input type="text" class="form-control" id="email" placeholder="メールアドレス" name="email">
            </div>
        </div>
    
        <div class="registpass">
            <div class="form-group">
                <input type="password" class="form-control" id="passwd" placeholder="パスワード" name="passwd">
            </div>
        </div>
        <div class="registpass">
            <div class="form-group">
                <input type="password" class="form-control" id="re_passwd" placeholder="再度入力してください" name="re_passwd">
            </div>
        </div>
    
        <div class="regist">
            <button class="registbutton" type="submit">
                新規登録
            </button>
        </div> 
    </form>

    <div class="teleworkline">
        <hr width="30%">
    </div>

    <div class="login">
        <p>アカウントをお持ちの場合はこちらから</p>
        <a href="login.html">ログイン</a>
    </div>


    <div class="teleworkline">
        <hr width="30%">
    </div>

    <div class="otoiawase">
        <a href="inquiries.html">お問い合わせはこちら</a>
    </div>

    </div>

    <div class="footer">
        <footer>
            <p>&copy; Nama-Avalanche. 2021</p> 
        </footer>
    </div>



<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js" integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI" crossorigin="anonymous"></script>
</body>
</html>


<script type="text/javascript">
    function check() {
        const u = document.getElementById("username");
        const e = document.getElementById("email");
        const p = document.getElementById("passwd");
        const rp = document.getElementById("re_passwd");

        const username = u.value;
        const email = e.value;
        const passwd = p.value;
        const re_pass = rp.value;
/*
        if (!username) {
            alert("氏名が入力されていません");
            return false;
        }
        if (!email) {
            alert("メールアドレスが入力されていません");
            return false;
        }
        if (!passwd) {
            alert("パスワードが入力されていません");
            return false;
        }
        if (!re_pass){
            alert("パスワードが入力されていません");
            return false;
        }
        
        if (passwd != re_pass) {
            alert("パスワードが一致しません")
            return false;
        }
*/

    }

</script>
